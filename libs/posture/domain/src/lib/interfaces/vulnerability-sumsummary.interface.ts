import { VulnerabilitySeverityTextEnum } from '@armo/posture/domain'

interface Sum {
  relevancy: VulnerabilitySeverityTextEnum,
  sum: number
}

interface History {
  containerScanID: string,
  timestamp: string | number
}

export interface VulnerabilitySumSummary {  
  customerGUID: string,
  containersScanID: string,
  timestamp: string | number,
  wlid: string,
  imageTag: string,
  imageHash: string,
  cluster: string,
  namespace: string,
  containerName: string,
  packages: string[],
  severities: string[],
  relevancies: string[],
  fixes: string[],
  listOfDangerousArtifcats: string[],
  severitiesSum: Sum[],
  relevanciesSum: Sum[],
  fixAvailbleSum: Sum[],
  status: string,
  registry: string,
  versionImage: string,
  numOfUnknownSeverity: number,
  numOfNegligibleSeverity: number,
  numOfLowSeverity: number,
  numOfMeduiumSeverity: number,
  numOfHighSeverity: number,
  numOfCriticalSeverity: number,
  numOfRelevantUnknownSeverity: number,
  numOfRelevantNegligibleSeverity: number,
  numOfRelevantLowSeverity: number,
  numOfRelevantMediumSeverity: number,
  numOfHighRelevantSeverity: number,
  numOfRelevantCriticalSeverity: number,
  numOfFixAvailableUnknownSeverity: number,
  numOfFixAvailableNegligibleSeverity: number,
  numOfFixAvailableLowSeverity: number,
  numOfFixAvailableMediumSeverity: number,
  numOfFixAvailableHighSeverity: number,
  numOfFixAvailableCriticalSeverity: number,
  numOfRelevantIssues: number,
  numOfIrelevantIssues: number,
  numOfUnknownIssues: number,
  numOfLeakedSecrets: number,
  version: string,
  history: History[],
  urgent: number,
  neglected: number,
  healthStatus: string
}

export interface VulnerabilitySummaryTable {
  scanTime: Date,
  status: string,
  wlid: string,
  container: string,
  registry: string,
  imageTag: string,
  severitiesSum: number[],
  relevanciesSum: number[],
  fixAvailbleSum: number[]
}

export interface VulnerabilitySummaryData { 
  data: VulnerabilitySummaryTable[]
}